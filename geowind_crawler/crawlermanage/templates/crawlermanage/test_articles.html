{% extends "crawlermanage/index.html" %}
{% block head %}
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>批量测试</title>
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
<!-- Bootstrap 3.3.6 -->
<link rel="stylesheet" href="../../static/bootstrap/css/bootstrap.min.css">
<link rel="stylesheet" href="../../static/style/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="../../static/plugins/iCheck/flat/blue.css">
<link rel="stylesheet" href="../../static/plugins/datatables/dataTables.bootstrap.css">
<link rel="stylesheet" href="../../static/plugins/daterangepicker/daterangepicker.css">
<link rel="stylesheet" href="../../static/plugins/select2/select2.min.css">
<link rel="stylesheet" href="../../static/dist/css/AdminLTE.min.css">
<link rel="stylesheet" href="../../static/dist/css/skins/_all-skins.min.css">
<meta charset="UTF-8">
<title>ECharts map Demo</title>
<style>

.col-center-block {
     float: none;
     display: block;
     margin-left: auto;
     margin-right: auto;
}

</style>
</head>
{% endblock %}
{% block sidebar %}
      <ul class="sidebar-menu">
        <li class="header">主控面板</li>
        <li class="treeview">
          <a href="#">
            <i class="fa fa-dashboard"></i> <span>查看任务</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li><a href="{%url 'tasks' %}"><i class="fa fa-circle-o"></i>爬虫状态</a></li>
            <!--<li><a href="{%url 'newsdata'%}"><i class="fa fa-circle-o"></i>数据显示</a></li>-->
          </ul>
        </li>
        <li>
          <a href="{%url 'layout'%}">
            <i class="fa fa-tasks"></i> <span>布置任务</span>
            <!-- <span class="pull-right-container">
              <small class="label pull-right bg-green">new</small>
            </span> -->
          </a>
        </li>
        <li class="active treeview">
          <a href="#">
            <i class="fa fa-dashboard"></i> <span>正文测试</span>
            <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
          </a>
          <ul class="treeview-menu">
            <li><a href="{%url 'extractarticle' %}"><i class="fa fa-circle-o"></i>批量抽取</a></li>
            <li class="active"><a href="{%url 'testarticles' %}"><i class="fa fa-circle-o"></i>批量测试</a></li>
            <!--<li><a href="{%url 'newsdata'%}"><i class="fa fa-circle-o"></i>数据显示</a></li>-->
          </ul>
        </li>
        <li>
          <a href="pages/widgets.html">
            <i class="fa fa-book"></i> <span>使用说明</span>
          </a>
        </li>

        <li>
          <a href="pages/widgets.html">
            <i class="fa fa-share"></i> <span>联系我们</span>
          </a>
        </li>
      </ul>
{% endblock %}
{% block maincontent %}
<div class="box box-primary">
  <div class="box-header with-border">
    <h3 class="box-title">准确率测试</h3>
  </div>
  <!-- /.box-header -->
  <div class="box-body">

     <div id="test_pre">
        <div class="form-group">
            <label>正文标准结果集路径</label>
            <input id="original_folder" name="" type="text" class="form-control" placeholder="文件夹路径...">
        </div>
        <div class="form-group">
            <label>正文抽取结果集路径</label>
            <input id="goal_folder" name="" type="text" class="form-control" placeholder="文件夹路径...">
        </div>

    </div>

    <!-- <div id="test_loading" class="row col-center-block" style="display:none;">

          <i class="fa fa-spinner fa-pulse fa-3x fa-fw  col-center-block"></i>
          
          <h5 class="col-center-block" style="width:130px">正在测试，请稍后...</h5>
    </div> -->
    <div id="test_res">
        <div class="form-group">
          <label>测试日志</label>
          <textarea class="form-control" rows="10"  disabled=""></textarea>
        </div>
        <div class="form-group">
          <label>准确率</label>
          <input type="text" class="form-control" value="100%" disabled="">
        </div>
    </div>
  </div>


  <div class="box-footer">
    <button type="button" class="btn btn-primary pull-right" id="test_done" onclick="done_event()">抽取</button>
  </div>
    <div id="test_loading" class="overlay" style="display:none;">
        <i class="fa fa-refresh fa-spin"></i>
    </div>
</div>
{% endblock %}

{% block script %}

<script src="../../static/plugins/jQuery/jquery-2.2.3.min.js"></script>
<script src="../../static/bootstrap/js/bootstrap.min.js"></script>
<script src="../../static/dist/js/app.min.js"></script>
<script src="../../static/dist/js/demo.js"></script>
<script src="../../static/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="../../static/plugins/datatables/dataTables.bootstrap.min.js"></script>
<script src="../../static/plugins/select2/select2.full.min.js"></script>
<script src="../../static/plugins/bootstrap3-editable/js/moment.js"></script>
<script>
function done_event(){

    
    

    var goal_folder = $('#goal_folder').val();
    var original_folder = $('#original_folder').val();
    $('#test_loading').css('display','');
    $.post('/crawlermanage/extractarticle/', {original_folder:original_folder, goal_folder:goal_folder}, function(data) {
        // $('#test_pre').css('display','none');
        if(data!=null) {
          if(data['isFinished']=='yes') {
            //一段时间后
            // $('#test_pre').css('display','');
            // $('#test_res').css('display','');
            $('#test_loading').css('display','none');
            $("#finished").css('display','');
          }

        }
    }, 'json');
    //一段时间后
    //$('#test_res').css('display','');
    //$('#test_loading').css('display','none');

}
</script>
{% endblock %}